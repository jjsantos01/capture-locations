<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capturador de Ubicaci칩n con Categor칤as y Mapa</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="main-container">
    <div class="container">
      <h1>Capturador de Ubicaciones</h1>
      <p>Genera tu conjunto de datos georreferenciados. Basado en el sitio de <a href="https://www.ladata.mx/traza/" target="_blank">Traza by La Data</a>.</p>
        <h3 class="collapsible-header">Instrucciones</h3>
        <div id="description" class="collapsible-content">
            <ol>
                <li>Crea una o m치s categor칤as de los eventos que quieres capturar.</li>
                <li>Cuando quieras a침adir una ubicaci칩n tienes dos opciones:</li>
                <ul>
                    <li>Haz clic en el bot칩n de la categor칤a que creaste en el paso anterior para usar tu ubicaci칩n actual.</li>
                    <li>Haz clic en el mapa para seleccionar una ubicaci칩n.</li>
                </ul>
                <li>
                  Escribe una descripci칩n para la ubicaci칩n (opcional)
                  y guarda el registro. Si est치s creando el registro desp칰es de
                  hacer clic en el mapa, deber치s seleccionar una categor칤a tambi칠n.
                </li>
                <li>Cuando finalices de capturar todos los registros, puedes descargar el conjunto de datos en formato CSV o GeoJSON.</li>
                <li>Si ya tienes datos en CSV de una captura anterior, puedes subirlos y continuar a침adiendo m치s registros.</li>
                <li>Esta p치gina es privada y no guarda ning칰no de tus datos, todo ocurre en tu navegador.</li>
            </ol>
        </div>

        <div class="category-section">
          <h2>Creador de Categor칤as</h2>
          <p>Selecciona un color y escribe el nombre de la categor칤a que deseas crear:</p>
          <div class="category-inputs">
              <input type="color" id="categoryColor" value="#4CAF50">
              <input type="text" id="categoryName" placeholder="Nombre de la categor칤a">
              <button id="createCategoryBtn">Crear Categor칤a</button>
          </div>
          <div id="categoriesList">
              <p>Selecciona una categor칤a:</p>
              <div id="categoryButtons"></div>
          </div>
        </div>

        <div id="map"></div>
        <div id="coordsList"></div>

        <section class="file-section">
            <h3>Subir archivo CSV</h3>
            <div id="upload-section">
                <div class="file-upload">
                    <input type="file" id="uploadFile" accept=".csv" class="file-input">
                    <label for="uploadFile" class="file-label">
                        <span class="file-icon">游늬</span>
                        <span class="file-text">Seleccionar archivo CSV</span>
                    </label>
                </div>
                <p class="upload-info">Si ya tienes datos, puedes subirlos aqu칤</p>
            </div>
        </section>

        <section class="download-section">
            <h3>Descargar archivos</h3>
            <div id="download-buttons">
                <button id="downloadBtn">Descargar CSV</button>
                <button id="downloadGeoJSONBtn">Descargar GeoJSON</button>
                <button id="downloadMapButton">Exportar mapa (HTML)</button>
            </div>
        </section>

        <div id="editCategorySection">
          <h3>Editar categor칤as</h3>
          <div id="categoryButtonsEdit"></div>
        </div>

        <h3>Borrar datos</h3>
        <button id="clearLocalStorageBtn">Limpiar datos</button>

        <div id="infoSection>" class="info-section">
          <h3>Informaci칩n adicional</h3>
          <h4 class="collapsible-header">쯈uieres publicar tu mapa?</h4>
          <div class="collapsible-content" id="infoPublish">
            <p>
              Si despu칠s de capturar todas las ubicaciones quieres
              hacer p칰blico tu mapa para que los demas puedan verlo, la forma m치s f치cil es exportar el mapa
              en formato HTML. Luego, tienes que subir el archivo a un
              servicio de alojamiento de archivos est치ticos como <a href="https://tiiny.host/" target="_blank">Tiiny Host</a> o
              o <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.
              Tiny Host es mucho m치s sencillo, solo tienes que subir
              el archivo html, registrarte con un correo electr칩nico, personalizar
              el nombre de la URL y la plataforma te dar치 un enlace para compartir.
            </p>
          </div>
          <h4 class="collapsible-header">Cargar puntos en Google Maps</h4>
          <div class="collapsible-content">
            <p>
              Si prefieres cargar tu mapa en Google Maps, puedes hacerlo
              exportando los datos en formato CSV y luego importarlos
              en Google My Maps. Para hacerlo, sigue estos pasos:
              <ol>
                <li>Descarga el archivo CSV.</li>
                <li>Ve a <a href="https://www.google.com/maps/d/" target="_blank">Google My Maps</a> y haz clic en "Crear un mapa".</li>
                <li>En la barra lateral izquierda, haz clic en "Importar" y selecciona en "Subir" el archivo CSV.</li>
                <li>Selecciona solo las columnas "Latitude" y "Longitude" seg칰n corresponda para indicar las coordendas.
                   Luego tambi칠n puedes escoger una columna para ser t칤tulo de tus marcadores, aqu칤 podr칤as escoger la columna "description" o "category"
                </li>
                <li>Google My Maps importar치 todos los datos y los mostrar치 en el mapa.
                    Puedes personalizar los marcadores haciendo clic en estilos individuales,
                    luego escoger en "Agrupar sitios por" y seleccionar la columna "category" para poner color a los marcadores por categor칤a.
                    Tambi칠n puedes cambiar el icono de los marcadores y agregar etiquetas personalizadas.
                </li>
                <li>Finalmente, puedes compartir el mapa con otras personas.</li>
            </p>
          </div>
          <h4 class="collapsible-header">Hacer mapa colaborativo en Google Maps</h4>
          <div class="collapsible-content">
            <p>
              Si quieras que otras personas puedan a침adir ubicaciones al mapa,
              puedes hacer un mapa colaborativo en Google Maps. Estos son los pasos para hacerlo:
            </p>
              <ol>
                <li> Sigue las Instrucciones anteriores para cargar los puntos en Google Maps.</li>
                <li> En los controles del mapa, selecciona "Compartir" y luego escoge "Compartir en Drive".</li>
                <li>Puedes seleccionar invitar a personas por correo electr칩nico o
              "Obtener enlace para compartir" y copiar el enlace para compartirlo.</li>
              <li>Selecciona el rol "Editar" para que otros puedan a침adir ubicaciones.</li>
              </ol>
              <p>Debes tener mucho cuidado al permitir que cualquiera edite tus mapas, ya que pueden insertar informaci칩n err칩nea o maliciosa.</p>

          </div>

      </div>
    </div>
</div>

    <div id="sidepanel" class="sidepanel">
      <span id="closeSidepanel" class="closeSidepanel">칑</span>
      <h2>A침adir descripci칩n</h2>

      <div id="sidepanelContent">
        <label for="categorySelect">Categor칤a:</label>
        <select id="categorySelect"></select>

        <label for="sidepanelDescription">Descripci칩n:</label>
        <textarea id="sidepanelDescription"></textarea>

        <button id="saveDescription">Guardar</button>
        <button id="cancelDescription">Cancelar</button>
      </div>
    </div>

    <div id="sidepanelEditCategory" class="sidepanel">
      <span id="closeSidepanelEditCategory" class="closeSidepanel">칑</span>
      <h2>Editar categor칤a</h2>
      <div id="sidepanelContentEditCategory">
        <label for="editCategoryName">Nombre:</label>
        <input type="text" id="editCategoryName" placeholder="Nombre de la categor칤a">

        <label for="editCategoryColor">Color:</label>
        <input type="color" id="editCategoryColor">

        <div id="categoryActionsButtons">
          <button id="saveCategoryEdit">Guardar</button>
          <button id="cancelCategoryEdit">Cancelar</button>
          <button id="deleteCategory" class="delete-btn">Eliminar</button>
        </div>

      </div>
      </div>
    </div>

    <footer>
      <p>
        Creado por <a href="https://twitter.com/jjsantoso" target="_blank">@jjsantoso</a>
        - <a href="https://github.com/jjsantos01" target="_blank">GitHub</a>
        - <a href="https://www.jjsantoso.com/" target="_blank">Web</a>
      </p>
    </footer>


    <script src="script.js"></script>
</body>
</html>
